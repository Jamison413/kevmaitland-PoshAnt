**********************
Windows PowerShell transcript start
Start time: 20180119120013
Username: SUSTAINLTD\kevin.maitland
RunAs User: SUSTAINLTD\kevin.maitland
Machine: NETMON (Microsoft Windows NT 10.0.15063.0)
Host Application: C:\WINDOWS\system32\WindowsPowerShell\v1.0\PowerShell_ISE.exe
Process ID: 6284
PSVersion: 5.1.15063.786
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.15063.786
BuildVersion: 10.0.15063.786
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
WARNING: The names of some imported commands from the module '_REST_Library-SPO' include unapproved verbs that might make them less discoverable. To find the commands with unapproved verbs, run the Import-Module command again with the Verbose parameter. For a list of approved verbs, type Get-Verb.
WARNING: The names of some imported commands from the module '_PS_Library_GeneralFunctionality' include unapproved verbs that might make them less discoverable. To find the commands with unapproved verbs, run the Import-Module command again with the Verbose parameter. For a list of approved verbs, type Get-Verb.
WARNING: The names of some imported commands from the module '_CSOM_Library-SPO' include unapproved verbs that might make them less discoverable. To find the commands with unapproved verbs, run the Import-Module command again with the Verbose parameter. For a list of approved verbs, type Get-Verb.
WARNING: The names of some imported commands from the module '_PS_Library_GeneralFunctionality' include unapproved verbs that might make them less discoverable. To find the commands with unapproved verbs, run the Import-Module command again with the Verbose parameter. For a list of approved verbs, type Get-Verb.
get-itemsInList: Invoke-SPORestMethod -Url https://anthesisllc.sharepoint.com/teams/communities/_api/web/Lists/GetByTitle('TaxonomyHiddenList')/items
	SUCCESS: Initial 5 items returned
get-itemsInList: Invoke-SPORestMethod -Url https://anthesisllc.sharepoint.com/teams/communities/Recruitment/_api/web/Lists/GetByTitle('UK Roles')/items?$filter=MailFolderArchived eq 0
	SUCCESS: Initial 1 items returned
Reconciling e-mail folders: 19 Inbox folders and 1 Job Roles found
No new e-mail folders need creating in Inbox
No Job Roles are On-Hold
No Job Roles are Closed (that we haven't already archived)
Found 22 e-mails that need processing
Found e-mail from contact@anthesisgroup.com with Subject FW: Jobs at Anthesisgroup London
Found e-mail from greenjobs@jobboard.strategies.co.uk with Subject Job Expiry Notification 19/01/2018
Found e-mail from fabien.laplace@gmail.com with Subject ESG & Supply Chain Internship application
Found e-mail from robertcannings@btinternet.com with Subject Sustainability Data Analyst Application
Found e-mail from sergiujiduc@gmail.com with Subject Sustainability Data Analyst_ECCAS1 - Application
Found e-mail from maggie.weglinski@anthesisgroup.com with Subject FW: Application for the role of Consultant
Found e-mail from ea.newsmailer@environment-analyst.com with Subject News alert: Arcadis enhances analytics capability through acquisition; UK EC sector strong in spite of Brexit; industry reacts to UK govt's 25-year green plan
Found e-mail from kevin.maitland@anthesisgroup.com with Subject WRS1 attachment test
Exactly 1 JobCode found [WRS1]
$formattedJobIdData = 'Label':"WRS1", 'WssId':-1, 'TermGuid':"908de327-837e-4bb9-b34f-ebfb783ce47a"
Trying to create Candidate List Item
new-itemInList(/teams/communities/Recruitment,UK Role Candidates,SP.Data.Role_x0020_CandidatesListItem,Last_x0020_Name=Maitland; Application_x0020_received=01/18/2018 15:40:30; RoleID={'__metadata':{'type':'SP.Taxonomy.TaxonomyFieldValue'},'Label':"WRS1", 'WssId':-1, 'TermGuid':"908de327-837e-4bb9-b34f-ebfb783ce47a"}; First_x0020_Name=Kev; Title=Kev Maitland; E_x002d_mail_x0020_address=kevin.maitland@anthesisgroup.com;
Invoke-SPORestMethod -Url https://anthesisllc.sharepoint.com/teams/communities/Recruitment/_api/web/Lists/GetByTitle('UK Role Candidates')/items -Method "POST" -Metadata { '__metadata': { 'type': 'SP.Data.Role_x0020_CandidatesListItem' }, 'Last_x0020_Name':"Maitland", 'Application_x0020_received':"01/18/2018 15:40:30", 'RoleID':{'__metadata':{'type':'SP.Taxonomy.TaxonomyFieldValue'},'Label':"WRS1", 'WssId':-1, 'TermGuid':"908de327-837e-4bb9-b34f-ebfb783ce47a"}, 'First_x0020_Name':"Kev", 'Title':"Kev Maitland", 'E_x002d_mail_x0020_address':"kevin.maitland@anthesisgroup.com"} -RequestDigest 0x5DD85B1C3D932C8073438A0020EA3E596AFBE03AE3A69DC51E25C301D49892B1835FA1233B05CF4745AD6D04457ABC6BC222B5B49BD1CBBF604C08B7B1FBE45C,19 Jan 2018 12:00:25 -0000
	SUCCESS: New item created
E-mail has attachments
Attempting to save attachment as C:\Users\kevinm\AppData\Local\Temp\Pretend CoveringLeter.docx
add-attachmentToListItem -serverUrl https://anthesisllc.sharepoint.com -sitePath /teams/communities/Recruitment -listItem https://anthesisllc.sharepoint.com/teams/communities/Recruitment/_api/Web/Lists(guid'78fa2d35-626e-49e6-8bd5-4cec9fc40fab')/Items(18) -filePathAndName C:\Users\kevinm\AppData\Local\Temp\Pretend CoveringLeter.docx -restCreds Microsoft.SharePoint.Client.SharePointOnlineCredentials
$digest = 0x5DD85B1C3D932C8073438A0020EA3E596AFBE03AE3A69DC51E25C301D49892B1835FA1233B05CF4745AD6D04457ABC6BC222B5B49BD1CBBF604C08B7B1FBE45C,19 Jan 2018 12:00:25 -0000)
$digest = 0x5DD85B1C3D932C8073438A0020EA3E596AFBE03AE3A69DC51E25C301D49892B1835FA1233B05CF4745AD6D04457ABC6BC222B5B49BD1CBBF604C08B7B1FBE45C,19 Jan 2018 12:00:25 -0000)
$url = https://anthesisllc.sharepoint.com/teams/communities/Recruitment/_api/Web/Lists(guid'78fa2d35-626e-49e6-8bd5-4cec9fc40fab')/Items(18)/AttachmentFiles/add(Filename='Pretend%20CoveringLeter.docx')
$fileContent.Length = 51653
High-five!
Attempting to save attachment as C:\Users\kevinm\AppData\Local\Temp\Pretend CV.docx
add-attachmentToListItem -serverUrl https://anthesisllc.sharepoint.com -sitePath /teams/communities/Recruitment -listItem https://anthesisllc.sharepoint.com/teams/communities/Recruitment/_api/Web/Lists(guid'78fa2d35-626e-49e6-8bd5-4cec9fc40fab')/Items(18) -filePathAndName C:\Users\kevinm\AppData\Local\Temp\Pretend CV.docx -restCreds Microsoft.SharePoint.Client.SharePointOnlineCredentials
$digest = 0x5DD85B1C3D932C8073438A0020EA3E596AFBE03AE3A69DC51E25C301D49892B1835FA1233B05CF4745AD6D04457ABC6BC222B5B49BD1CBBF604C08B7B1FBE45C,19 Jan 2018 12:00:25 -0000)
$digest = 0x5DD85B1C3D932C8073438A0020EA3E596AFBE03AE3A69DC51E25C301D49892B1835FA1233B05CF4745AD6D04457ABC6BC222B5B49BD1CBBF604C08B7B1FBE45C,19 Jan 2018 12:00:25 -0000)
$url = https://anthesisllc.sharepoint.com/teams/communities/Recruitment/_api/Web/Lists(guid'78fa2d35-626e-49e6-8bd5-4cec9fc40fab')/Items(18)/AttachmentFiles/add(Filename='Pretend%20CV.docx')
$fileContent.Length = 51640
Exception calling "GetResponse" with "0" argument(s): "The operation has timed out"
At C:\Users\kevinm\Documents\WindowsPowerShell\Modules\_REST_Library-SPO\_REST_Library-SPO.psm1:229 char:5
+     $response = $request.GetResponse()
+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : WebException
Exception calling "GetResponse" with "0" argument(s): "The operation has timed out"
At C:\Users\kevinm\Documents\WindowsPowerShell\Modules\_REST_Library-SPO\_REST_Library-SPO.psm1:229 char:5
+     $response = $request.GetResponse()
+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : WebException

add-attachmentToListItem -serverUrl https://anthesisllc.sharepoint.com -sitePath /teams/communities/Recruitment -listItem https://anthesisllc.sharepoint.com/teams/communities/Recruitment/_api/Web/Lists(guid'78fa2d35-626e-49e6-8bd5-4cec9fc40fab')/Items(18) -filePathAndName C:\Users\kevinm\AppData\Local\Temp\Pretend CV.docx -restCreds Microsoft.SharePoint.Client.SharePointOnlineCredentials
$digest = 0x5DD85B1C3D932C8073438A0020EA3E596AFBE03AE3A69DC51E25C301D49892B1835FA1233B05CF4745AD6D04457ABC6BC222B5B49BD1CBBF604C08B7B1FBE45C,19 Jan 2018 12:00:25 -0000)
$digest = 0x5DD85B1C3D932C8073438A0020EA3E596AFBE03AE3A69DC51E25C301D49892B1835FA1233B05CF4745AD6D04457ABC6BC222B5B49BD1CBBF604C08B7B1FBE45C,19 Jan 2018 12:00:25 -0000)
$url = https://anthesisllc.sharepoint.com/teams/communities/Recruitment/_api/Web/Lists(guid'78fa2d35-626e-49e6-8bd5-4cec9fc40fab')/Items(18)/AttachmentFiles/add(Filename='Pretend%20CV.docx')
$fileContent.Length = 51640
Exception calling "GetResponse" with "0" argument(s): "The operation has timed out"
At C:\Users\kevinm\Documents\WindowsPowerShell\Modules\_REST_Library-SPO\_REST_Library-SPO.psm1:229 char:5
+     $response = $request.GetResponse()
+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : WebException
Exception calling "GetResponse" with "0" argument(s): "The operation has timed out"
At C:\Users\kevinm\Documents\WindowsPowerShell\Modules\_REST_Library-SPO\_REST_Library-SPO.psm1:229 char:5
+     $response = $request.GetResponse()
+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : WebException

add-attachmentToListItem -serverUrl https://anthesisllc.sharepoint.com -sitePath /teams/communities/Recruitment -listItem https://anthesisllc.sharepoint.com/teams/communities/Recruitment/_api/Web/Lists(guid'78fa2d35-626e-49e6-8bd5-4cec9fc40fab')/Items(18) -filePathAndName C:\Users\kevinm\AppData\Local\Temp\Pretend CV.docx -restCreds Microsoft.SharePoint.Client.SharePointOnlineCredentials
$digest = 0x5DD85B1C3D932C8073438A0020EA3E596AFBE03AE3A69DC51E25C301D49892B1835FA1233B05CF4745AD6D04457ABC6BC222B5B49BD1CBBF604C08B7B1FBE45C,19 Jan 2018 12:00:25 -0000)
$digest = 0x5DD85B1C3D932C8073438A0020EA3E596AFBE03AE3A69DC51E25C301D49892B1835FA1233B05CF4745AD6D04457ABC6BC222B5B49BD1CBBF604C08B7B1FBE45C,19 Jan 2018 12:00:25 -0000)
$url = https://anthesisllc.sharepoint.com/teams/communities/Recruitment/_api/Web/Lists(guid'78fa2d35-626e-49e6-8bd5-4cec9fc40fab')/Items(18)/AttachmentFiles/add(Filename='Pretend%20CV.docx')
$fileContent.Length = 51640
PS>TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
>> TerminatingError(): "The pipeline has been stopped."
PS C:\Users\kevinm> $dummyCandidate = get-itemsInList -serverUrl $webUrl -sitePath $($recruitmentSiteCollection+$recruitmentSite) -listName "UK Role Candidates" -restCreds $restCreds -logFile $logFile -oDataQuery "&`$filter=Id eq 18" #Quickly find the field names in SPO
PS C:\Users\kevinm> TerminatingError(Invoke-SPORestMethod): "Exception calling "GetResponse" with "0" argument(s): "The operation has timed out""
PS C:\Users\kevinm> $dummyCandidate 
False
PS C:\Users\kevinm> $dummyCandidate = get-itemsInList -serverUrl $webUrl -sitePath $($recruitmentSiteCollection+$recruitmentSite) -listName "UK Role Candidates" -restCreds $restCreds -logFile $logFile -oDataQuery "&`$filter=Id eq 18" -verboseLogging $true #Quickly find the field names in SPO
get-itemsInList: Invoke-SPORestMethod -Url https://anthesisllc.sharepoint.com/teams/communities/Recruitment/_api/web/Lists/GetByTitle('UK Role Candidates')/items?&$filter=Id eq 18
PS C:\Users\kevinm> TerminatingError(Invoke-SPORestMethod): "Exception calling "GetResponse" with "0" argument(s): "The operation has timed out""
get-itemsInList(/teams/communities/Recruitment, UK Role Candidates) failed to execute
Exception calling "GetResponse" with "0" argument(s): "The operation has timed out"
