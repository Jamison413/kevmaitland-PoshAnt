Import-Module _REST_Library-Kimble

########################################
#Don't change these unless the Kimble account or App changes
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
$callbackUri = "https://login.salesforce.com/services/oauth2/token" #"https://test.salesforce.com/services/oauth2/token"
$grantType = "password"
$myInstance = "https://eu5.salesforce.com"
$queryUri = "$myInstance/services/data/v39.0/query/?q="
$querySuffixStub = " -H `"Authorization: Bearer "
$kimbleLogin = Import-Csv "$env:USERPROFILE\Desktop\Kimble.txt"
$clientId = $kimbleLogin.clientId
$clientSecret = $kimbleLogin.clientSecret
$username = $kimbleLogin.username
$password = $kimbleLogin.password
$securityToken = $kimbleLogin.securityToken
########################################

$oAuthReqBody = Get-KimbleAuthorizationTokenWithUsernamePasswordFlowRequestBody -client_id $clientId -client_secret $clientSecret -user_name $username -pass_word $password -security_token $securityToken
try{$kimbleAccessToken=Invoke-RestMethod -Method Post -Uri $callbackUri -Body $oAuthReqBody} catch {Failure}
$kimbleRestHeaders = @{Authorization = "Bearer " + $kimbleAccessToken.access_token}




#Duff 
#SFSSDupeCatcher__Override_DupeCatcher__c
#MC4SF__MC_Subscriber__c
#KimbleOne__DeliveryElement__c.KimbleOne__IncludeInDeliveryGroupRollup__c
#KimbleOne__DeliveryElement__c.KimbleOne__BaselineExpensesContractMargin__c
#KimbleOne__DeliveryElement__c.KimbleOne__BaselineExpensesContractMarginAmount__c
#KimbleOne__DeliveryGroup__c.KimbleOne__Opportunity__c
#KimbleOne__Proposal__c.KimbleOne__Opportunity__c
#KimbleOne__SalesOpportunity__c.Name_No_Overide__c
#KimbleOne__SalesOpportunity__c.KimbleOne__Opportunity__c"









#Needs Admin login
$soqlQuery = "Select l.Website, l.Title, l.SystemModstamp, l.Street, l.Status, l.State, l.Sign_up_to_our_newsletter__c, l.Salutation, l.SFSSDupeCatcher__Override_DupeCatcher__c, l.Region__c, l.Rating, l.PostalCode, l.PhotoUrl, l.Phone, l.OwnerId, l.Number_of_Employees__c, l.NumberOfEmployees, l.Name, l.MasterRecordId, l.MC4SF__MC_Subscriber__c, l.Longitude, l.LeadSource, l.Latitude, l.LastViewedDate, l.LastReferencedDate, l.LastName, l.LastModifiedDate, l.LastModifiedById, l.LastActivityDate, l.JigsawContactId, l.Jigsaw, l.IsUnreadByOwner, l.IsDeleted, l.IsConverted, l.Industry, l.Id, l.GeocodeAccuracy, l.FirstName, l.EmailBouncedReason, l.EmailBouncedDate, l.Email, l.Description, l.CurrencyIsoCode, l.CreatedDate, l.CreatedById, l.Country, l.ConvertedOpportunityId, l.ConvertedDate, l.ConvertedContactId, l.ConvertedAccountId, l.Company, l.Client_Sector__c, l.City, l.Campaign__c, l.Blog_title__c, l.AnnualRevenue, l.Address From Lead l"
$leads = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select u.Username, u.UserType, u.UserRoleId, u.UserPreferencesTaskRemindersCheckboxDefault, u.UserPreferencesSortFeedByComment, u.UserPreferencesShowWorkPhoneToGuestUsers, u.UserPreferencesShowWorkPhoneToExternalUsers, u.UserPreferencesShowTitleToGuestUsers, u.UserPreferencesShowTitleToExternalUsers, u.UserPreferencesShowStreetAddressToGuestUsers, u.UserPreferencesShowStreetAddressToExternalUsers, u.UserPreferencesShowStateToGuestUsers, u.UserPreferencesShowStateToExternalUsers, u.UserPreferencesShowProfilePicToGuestUsers, u.UserPreferencesShowPostalCodeToGuestUsers, u.UserPreferencesShowPostalCodeToExternalUsers, u.UserPreferencesShowMobilePhoneToGuestUsers, u.UserPreferencesShowMobilePhoneToExternalUsers, u.UserPreferencesShowManagerToGuestUsers, u.UserPreferencesShowManagerToExternalUsers, u.UserPreferencesShowFaxToGuestUsers, u.UserPreferencesShowFaxToExternalUsers, u.UserPreferencesShowEmailToGuestUsers, u.UserPreferencesShowEmailToExternalUsers, u.UserPreferencesShowCountryToGuestUsers, u.UserPreferencesShowCountryToExternalUsers, u.UserPreferencesShowCityToGuestUsers, u.UserPreferencesShowCityToExternalUsers, u.UserPreferencesReminderSoundOff, u.UserPreferencesPreviewLightning, u.UserPreferencesPathAssistantCollapsed, u.UserPreferencesLightningExperiencePreferred, u.UserPreferencesHideSfxWelcomeMat, u.UserPreferencesHideSecondChatterOnboardingSplash, u.UserPreferencesHideS1BrowserUI, u.UserPreferencesHideLightningMigrationModal, u.UserPreferencesHideEndUserOnboardingAssistantModal, u.UserPreferencesHideChatterOnboardingSplash, u.UserPreferencesHideCSNGetChatterMobileTask, u.UserPreferencesHideCSNDesktopTask, u.UserPreferencesHideBiggerPhotoCallout, u.UserPreferencesGlobalNavGridMenuWTShown, u.UserPreferencesGlobalNavBarWTShown, u.UserPreferencesEventRemindersCheckboxDefault, u.UserPreferencesEnableAutoSubForFeeds, u.UserPreferencesDisableSharePostEmail, u.UserPreferencesDisableProfilePostEmail, u.UserPreferencesDisableMessageEmail, u.UserPreferencesDisableMentionsPostEmail, u.UserPreferencesDisableLikeEmail, u.UserPreferencesDisableLaterCommentEmail, u.UserPreferencesDisableFollowersEmail, u.UserPreferencesDisableFileShareNotificationsForApi, u.UserPreferencesDisableEndorsementEmail, u.UserPreferencesDisableChangeCommentEmail, u.UserPreferencesDisableBookmarkEmail, u.UserPreferencesDisableAllFeedsEmail, u.UserPreferencesDisProfPostCommentEmail, u.UserPreferencesDisMentionsCommentEmail, u.UserPreferencesDisCommentAfterLikeEmail, u.UserPreferencesCreateLEXAppsWTShown, u.UserPreferencesContentNoEmail, u.UserPreferencesContentEmailAsAndWhen, u.UserPreferencesCacheDiagnostics, u.UserPreferencesApexPagesDeveloperMode, u.UserPreferencesActivityRemindersPopup, u.UserPermissionsSupportUser, u.UserPermissionsSFContentUser, u.UserPermissionsOfflineUser, u.UserPermissionsMobileUser, u.UserPermissionsMarketingUser, u.UserPermissionsInteractionUser, u.UserPermissionsChatterAnswersUser, u.UserPermissionsCallCenterAutoLogin, u.UserPermissionsAvantgoUser, u.Title, u.TimeZoneSidKey, u.SystemModstamp, u.Street, u.StayInTouchSubject, u.StayInTouchSignature, u.StayInTouchNote, u.State, u.SmallPhotoUrl, u.SmallBannerPhotoUrl, u.Signature, u.SenderName, u.SenderEmail, u.ReceivesInfoEmails, u.ReceivesAdminInfoEmails, u.ProfileId, u.PostalCode, u.Phone, u.OfflineTrialExpirationDate, u.OfflinePdaTrialExpirationDate, u.Name, u.MobilePhone, u.MediumPhotoUrl, u.MediumBannerPhotoUrl, u.ManagerId, u.Longitude, u.LocaleSidKey, u.Latitude, u.LastViewedDate, u.LastReferencedDate, u.LastPasswordChangeDate, u.LastName, u.LastModifiedDate, u.LastModifiedById, u.LastLoginDate, u.LanguageLocaleKey, u.KimbleOne__RerouteApprovalRequests__c, u.IsProfilePhotoActive, u.IsActive, u.Id, u.GeocodeAccuracy, u.FullPhotoUrl, u.ForecastEnabled, u.FirstName, u.FederationIdentifier, u.Fax, u.Extension, u.EmployeeNumber, u.EmailPreferencesStayInTouchReminder, u.EmailPreferencesAutoBccStayInTouch, u.EmailPreferencesAutoBcc, u.EmailEncodingKey, u.Email, u.Division, u.DigestFrequency, u.Department, u.DelegatedApproverId, u.DefaultGroupNotificationFrequency, u.DefaultCurrencyIsoCode, u.CurrencyIsoCode, u.CreatedDate, u.CreatedById, u.Country, u.ContactId, u.CompanyName, u.CommunityNickname, u.City, u.CallCenterId, u.BannerPhotoUrl, u.BadgeText, u.Alias, u.Address, u.AccountId, u.AboutMe From User u"
$users = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders

#Needs user login
$soqlQuery = "Select e.WhoId, e.WhatId, e.SystemModstamp, e.Subject, e.StartDateTime, e.ShowAs, e.ReminderDateTime, e.RecurrenceType, e.RecurrenceTimeZoneSidKey, e.RecurrenceStartDateTime, e.RecurrenceMonthOfYear, e.RecurrenceInterval, e.RecurrenceInstance, e.RecurrenceEndDateOnly, e.RecurrenceDayOfWeekMask, e.RecurrenceDayOfMonth, e.RecurrenceActivityId, e.OwnerId, e.Location, e.LastModifiedDate, e.LastModifiedById, e.KimbleOne__IsSynchronisedWithAssignment__c, e.KimbleOne__AlertInCalendar__c, e.IsReminderSet, e.IsRecurrence, e.IsPrivate, e.IsGroupEvent, e.IsDeleted, e.IsChild, e.IsArchived, e.IsAllDayEvent, e.Id, e.GroupEventType, e.EventSubtype, e.EndDateTime, e.DurationInMinutes, e.Description, e.CurrencyIsoCode, e.CreatedDate, e.CreatedById, e.ActivityDateTime, e.ActivityDate, e.AccountId From Event e"
$events = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select f.Type, f.SystemModstamp, f.NamespacePrefix, f.Name, f.LastModifiedDate, f.LastModifiedById, f.IsReadonly, f.Id, f.DeveloperName, f.CreatedDate, f.CreatedById, f.AccessType From Folder f"
$folders = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select g.Type, g.SystemModstamp, g.RelatedId, g.OwnerId, g.Name, g.LastModifiedDate, g.LastModifiedById, g.Id, g.Email, g.DoesSendEmailToMembers, g.DoesIncludeBosses, g.DeveloperName, g.CreatedDate, g.CreatedById From Group g"
$groups = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select g.UserOrGroupId, g.SystemModstamp, g.Id, g.GroupId From GroupMember g"
$groupMembers = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select k.SystemModstamp, k.OwnerId, k.Name, k.LastViewedDate, k.LastReferencedDate, k.LastModifiedDate, k.LastModifiedById, k.KimbleOne__TimePattern__c, k.KimbleOne__TimePatternVariant__c, k.KimbleOne__TimePatternRule__c, k.KimbleOne__TaxCode__c, k.KimbleOne__TaxCodeReference__c, k.KimbleOne__PurchaseOrderRule__c, k.KimbleOne__LogoDocumentName__c, k.KimbleOne__IsTradingEntity__c, k.KimbleOne__IsSecondaryOrganisationalEntity__c, k.KimbleOne__IsPrimaryOrganisationalEntity__c, k.KimbleOne__IsOperatingEntity__c, k.KimbleOne__InvoicingStreet__c, k.KimbleOne__InvoicingStreetName__c, k.KimbleOne__InvoicingState__c, k.KimbleOne__InvoicingPostalCode__c, k.KimbleOne__InvoicingName__c, k.KimbleOne__InvoicingCurrencyIsoCode__c, k.KimbleOne__InvoicingCountry__c, k.KimbleOne__InvoicingCity__c, k.KimbleOne__InvoicingBusinessUnitName__c, k.KimbleOne__InvoicingAddress__c, k.KimbleOne__InvoiceTaxCodeNumber__c, k.KimbleOne__InvoiceFooter__c, k.KimbleOne__InvoiceBankAccount__c, k.KimbleOne__ExpenseItemSubmissionDays__c, k.KimbleOne__ExpenseItemExchangeRateTolerancePct__c, k.KimbleOne__DefaultInvoiceTemplate__c, k.KimbleOne__DefaultInvoiceExpensesTemplate__c, k.KimbleOne__DefaultCreditNoteTemplate__c, k.KimbleOne__CreditNoteFooter__c, k.KimbleOne__Calendar__c, k.KimbleOne__BusinessUnitGroup__c, k.IsDeleted, k.Id, k.CurrencyIsoCode, k.CreatedDate, k.CreatedById From KimbleOne__BusinessUnit__c k"
$kimbleBusinessUnits = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select k.SystemModstamp, k.OwnerId, k.Name, k.LastModifiedDate, k.LastModifiedById, k.KimbleOne__Proposal__c, k.KimbleOne__ObjectId__c, k.KimbleOne__IsComplete__c, k.KimbleOne__EventNarrative__c, k.KimbleOne__EventDate__c, k.KimbleOne__EventData__c, k.KimbleOne__EventClass__c, k.KimbleOne__DeliveryGroup__c, k.KimbleOne__DeliveryElement__c, k.KimbleOne__BaselineDate__c, k.IsDeleted, k.Id, k.CurrencyIsoCode, k.CreatedDate, k.CreatedById From KimbleOne__Event__c k"
$kimbleEvents = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select k.SystemModstamp, k.OwnerId, k.Name, k.LastViewedDate, k.LastReferencedDate, k.LastModifiedDate, k.LastModifiedById, k.KimbleOne__UsageTemplateBehaviourRule__c, k.KimbleOne__TaskTemplateCount__c, k.KimbleOne__ProductDomain__c, k.KimbleOne__MilestoneTemplateCount__c, k.KimbleOne__MilestoneTemplateBehaviourRule__c, k.KimbleOne__IsActive__c, k.KimbleOne__IsAbstract__c, k.KimbleOne__DefaultDescription__c, k.KimbleOne__BusinessUnit__c, k.KimbleOne__ActivityAssignmentTemplateCount__c, k.IsDeleted, k.Id, k.CurrencyIsoCode, k.CreatedDate, k.CreatedById From KimbleOne__Product__c k"
$kimbleProducts = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select k.SystemModstamp, k.OwnerId, k.Name, k.LastViewedDate, k.LastReferencedDate, k.LastModifiedDate, k.LastModifiedById, k.KimbleOne__User__c, k.KimbleOne__UsagePattern__c, k.KimbleOne__TimePattern__c, k.KimbleOne__TimePatternVariant__c, k.KimbleOne__TargetRate__c, k.KimbleOne__TargetRateUnitType__c, k.KimbleOne__StartDate__c, k.KimbleOne__StandardCost__c, k.KimbleOne__StandardCostUnitType__c, k.KimbleOne__ResourceType__c, k.KimbleOne__Reference__c, k.KimbleOne__PortalUser__c, k.KimbleOne__Notes__c, k.KimbleOne__Location__c, k.KimbleOne__LatestP1AssignmentEndDate__c, k.KimbleOne__LastName__c, k.KimbleOne__IsCurrentUser__c, k.KimbleOne__Group__c, k.KimbleOne__Grade__c, k.KimbleOne__FirstName__c, k.KimbleOne__ExternalId__c, k.KimbleOne__ExpenseReimbursementCurrencyIsoCode__c, k.KimbleOne__EndDate__c, k.KimbleOne__Contact__c, k.KimbleOne__Calendar__c, k.KimbleOne__BusinessUnit__c, k.KimbleOne__BusinessUnitSecondary__c, k.KimbleOne__BusinessUnitGroup__c, k.KimbleOne__AvailabilityUsagePattern__c, k.KimbleOne__ActualCost__c, k.KimbleOne__ActualCostUnitType__c, k.KimbleOne__ActivityRole__c, k.KimbleOne__ActiveLicenseType__c, k.IsDeleted, k.Id, k.HolidayEntitlement__c, k.CurrencyIsoCode, k.CreatedDate, k.CreatedById, k.Community__c From KimbleOne__Resource__c k"
$kimbleResources = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select t.WhoId, t.WhatId, t.TaskSubtype, t.SystemModstamp, t.Subject, t.Status, t.ReminderDateTime, t.RecurrenceType, t.RecurrenceTimeZoneSidKey, t.RecurrenceStartDateOnly, t.RecurrenceRegeneratedType, t.RecurrenceMonthOfYear, t.RecurrenceInterval, t.RecurrenceInstance, t.RecurrenceEndDateOnly, t.RecurrenceDayOfWeekMask, t.RecurrenceDayOfMonth, t.RecurrenceActivityId, t.Priority, t.OwnerId, t.LastModifiedDate, t.LastModifiedById, t.KimbleOne__IsSynchronisedWithAssignment__c, t.KimbleOne__AlertInCalendar__c, t.IsReminderSet, t.IsRecurrence, t.IsHighPriority, t.IsDeleted, t.IsClosed, t.IsArchived, t.Id, t.Description, t.CurrencyIsoCode, t.CreatedDate, t.CreatedById, t.CallType, t.CallObject, t.CallDurationInSeconds, t.CallDisposition, t.ActivityDate, t.AccountId From Task t"
$tasks = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select a.X2nd_Account_Owner__c, a.Website, a.Walmart_Supplier_Account__c, a.Walmart_Sub_Category__c, a.Walmart_Category_New__c, a.Type_of_Product__c, a.Type, a.SystemModstamp, a.Sym_Group__c, a.Supply_Since_Last_Update__c, a.Supplier_Sector__c, a.SicDesc, a.ShippingStreet, a.ShippingState, a.ShippingPostalCode, a.ShippingLongitude, a.ShippingLatitude, a.ShippingGeocodeAccuracy, a.ShippingCountry, a.ShippingCity, a.ShippingAddress, a.Received_Sust_Index_from_WM__c, a.Purchase_Type__c, a.PhotoUrl, a.Phone, a.Partner_Sector__c, a.ParentId, a.OwnerId, a.NumberOfEmployees, a.Name, a.Membership__c, a.MasterRecordId, a.LastViewedDate, a.LastReferencedDate, a.LastModifiedDate, a.LastModifiedById, a.LastActivityDate, a.KimbleOne__TaxCode__c, a.KimbleOne__TaxCodeReference__c, a.KimbleOne__PurchaseOrderRule__c, a.KimbleOne__Locale__c, a.KimbleOne__IsSupplier__c, a.KimbleOne__IsCustomer__c, a.KimbleOne__InvoicingCurrencyIsoCode__c, a.KimbleOne__InvoiceTemplate__c, a.KimbleOne__InvoicePaymentTermDays__c, a.KimbleOne__InvoiceFormat__c, a.KimbleOne__Code__c, a.KimbleOne__BusinessUnit__c, a.KimbleOne__BusinessUnitTradingEntity__c, a.KimbleOne__BillingParentAccount__c, a.KimbleOne__BillingContact__c, a.KimbleOne__AllowPartItemInvoicing__c, a.Key_Account__c, a.JigsawCompanyId, a.Jigsaw, a.Is_Partner__c, a.Is_Competitor__c, a.IsDeleted, a.Industry, a.Id, a.Have_you_completed_this_section__c, a.Generic_email_address__c, a.Fax, a.Description, a.D_U_N_S_Number__c, a.CurrencyIsoCode, a.CreatedDate, a.CreatedById, a.Client_Sector__c, a.BillingStreet, a.BillingState, a.BillingPostalCode, a.BillingLongitude, a.BillingLatitude, a.BillingGeocodeAccuracy, a.BillingCountry, a.BillingCity, a.BillingAddress, a.AnnualRevenue, a.Account_Manager__c, a.Account_Director__c, a.AccountSource From Account a"
$accounts = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select c.Unsubscribe_Newsletter_Campaigns__c, c.Twitter__c, c.Title, c.SystemModstamp, c.Skype__c, c.Secondary_contact_owner__c, c.Salutation, c.Role_Responsibilities__c, c.ReportsToId, c.Region__c, c.Previous_Company__c, c.PhotoUrl, c.Phone, c.OwnerId, c.Other_Email__c, c.OtherStreet, c.OtherState, c.OtherPostalCode, c.OtherPhone, c.OtherLongitude, c.OtherLatitude, c.OtherGeocodeAccuracy, c.OtherCountry, c.OtherCity, c.OtherAddress, c.No_Show_Event_Attendees__c, c.Nickname__c, c.Newsletters_Campaigns__c, c.Nee__c, c.Name, c.MobilePhone, c.Met_At__c, c.MasterRecordId, c.MailingStreet, c.MailingState, c.MailingPostalCode, c.MailingLongitude, c.MailingLatitude, c.MailingGeocodeAccuracy, c.MailingCountry, c.MailingCity, c.MailingAddress, c.Linked_In__c, c.Lead_Source_Detail__c, c.LeadSource, c.LastViewedDate, c.LastReferencedDate, c.LastName, c.LastModifiedDate, c.LastModifiedById, c.LastCUUpdateDate, c.LastCURequestDate, c.LastActivityDate, c.Key_areas_of_interest__c, c.JigsawContactId, c.Jigsaw, c.IsEmailBounced, c.IsDeleted, c.Id, c.HomePhone, c.Have_you_completed_this_section__c, c.Gender__c, c.FirstName, c.Fax, c.EmailBouncedReason, c.EmailBouncedDate, c.Email, c.Description, c.Department, c.CurrencyIsoCode, c.CreatedDate, c.CreatedById, c.Client_Type__c, c.Cleanup__c, c.Birthdate, c.AssistantPhone, c.AssistantName, c.Anthesis_Events__c, c.AccountId From Contact c"
$contacts = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select k.SystemModstamp, k.Name, k.LastModifiedDate, k.LastModifiedById, k.KimbleOne__WeightedContractRevenue__c, k.KimbleOne__UsageRevenues__c, k.KimbleOne__UsageForecastMode__c, k.KimbleOne__UsageCosts__c, k.KimbleOne__TaxCode__c, k.KimbleOne__TargetMargin__c, k.KimbleOne__SupplierPurchaseOrderRule__c, k.KimbleOne__SupplierInvoicingCurrencyRecurringCost__c, k.KimbleOne__SupplierInvoicingCurrencyIsoCode__c, k.KimbleOne__SupplierInvoicingCcyExpectedContractCost__c, k.KimbleOne__StartDate__c, k.KimbleOne__ShortName__c, k.KimbleOne__ServicesNotionalRevenue__c, k.KimbleOne__ServicesContractRevenue__c, k.KimbleOne__ServicesContractMargin__c, k.KimbleOne__ServicesContractMarginAmount__c, k.KimbleOne__ServicesContractCost__c, k.KimbleOne__RevenueUnitsPerPeriod__c, k.KimbleOne__RevenueUnitType__c, k.KimbleOne__RevenuePeriodType__c, k.KimbleOne__RevenueNumberOfPeriods__c, k.KimbleOne__RevenueMilestonesTotalValue__c, k.KimbleOne__RevenueForecastMode__c, k.KimbleOne__RevenueCap__c, k.KimbleOne__RevenueAdjustmentsTotal__c, k.KimbleOne__ResourcedActivity__c, k.KimbleOne__Reference__c, k.KimbleOne__RecurringRevenue__c, k.KimbleOne__RecurringCost__c, k.KimbleOne__PurchaseOrderRule__c, k.KimbleOne__Proposal__c, k.KimbleOne__Product__c, k.KimbleOne__ProductGroupProduct__c, k.KimbleOne__ProductExtension__c, k.KimbleOne__ProbabilityCodeEnum__c, k.KimbleOne__PeriodRevenuesTotal__c, k.KimbleOne__PeriodCostsTotal__c, k.KimbleOne__PayableProcessRequiresCompletion__c, k.KimbleOne__PayableProcessReferenceDateRule__c, k.KimbleOne__PayableProcessPoint__c, k.KimbleOne__PayableProcessOffsetPeriodType__c, k.KimbleOne__PayableProcessOffsetNumberOfPeriods__c, k.KimbleOne__PayablePeriodType__c, k.KimbleOne__PayableNumberOfPeriods__c, k.KimbleOne__OtherContractCost__c, k.KimbleOne__OriginatingProposal__c, k.KimbleOne__NotionalRevenue__c, k.KimbleOne__NotionalContractRevenue__c, k.KimbleOne__LatestReceivableItemDate__c, k.KimbleOne__LatestPayableItemDate__c, k.KimbleOne__LatestMilestoneDate__c, k.KimbleOne__LatestAssignmentEndDate__c, k.KimbleOne__LatestAnnuityEndDate__c, k.KimbleOne__IsRateOverridden__c, k.KimbleOne__InvoicingRequiresCompletion__c, k.KimbleOne__InvoicingReferenceDateRule__c, k.KimbleOne__InvoicingPoint__c, k.KimbleOne__InvoicingOffsetPeriodType__c, k.KimbleOne__InvoicingOffsetNumberOfPeriods__c, k.KimbleOne__InvoicingCurrencyUsageRevenues__c, k.KimbleOne__InvoicingCurrencyServicesContractRevenue__c, k.KimbleOne__InvoicingCurrencyRevenueCap__c, k.KimbleOne__InvoicingCurrencyRecurringRevenue__c, k.KimbleOne__InvoicingCurrencyPeriodRevenuesTotal__c, k.KimbleOne__InvoicingCurrencyMilestonesTotal__c, k.KimbleOne__InvoicingCurrencyIsoCode__c, k.KimbleOne__InvoicingCurrencyExpensesRevenue__c, k.KimbleOne__InvoicingCurrencyExpensesContractRevenue__c, k.KimbleOne__InvoicingCurrencyContractRevenue__c, k.KimbleOne__InvoicingCcyServicesInvoiceableAmount__c, k.KimbleOne__InvoicingCcyRevenueAdjustmentsTotal__c, k.KimbleOne__InvoicingCcyExpensesInvoiceableAmount__c, k.KimbleOne__InvoicingCcyExpectedContractRevenue__c, k.KimbleOne__InvoicingCanIncludeZeroRevenueItem__c, k.KimbleOne__InvoicePeriodType__c, k.KimbleOne__InvoiceNumberOfPeriods__c, k.KimbleOne__ForecastUsage__c, k.KimbleOne__ForecastStatus__c, k.KimbleOne__ExpensesRevenue__c, k.KimbleOne__ExpensesNotionalRevenue__c, k.KimbleOne__ExpensesCost__c, k.KimbleOne__ExpensesContractRevenue__c, k.KimbleOne__ExpensesContractMargin__c, k.KimbleOne__ExpensesContractMarginAmount__c, k.KimbleOne__ExpensesContractCost__c, k.KimbleOne__ExpectedUsage__c, k.KimbleOne__ExpectedContractRevenue__c, k.KimbleOne__ExpectedContractCost__c, k.KimbleOne__EnforceReceivableDate__c, k.KimbleOne__EnforcePayableDate__c, k.KimbleOne__EndDate__c, k.KimbleOne__EarliestReceivableItemDate__c, k.KimbleOne__EarliestPayableItemDate__c, k.KimbleOne__EarliestMilestoneDate__c, k.KimbleOne__EarliestAssignmentStartDate__c, k.KimbleOne__EarliestAnnuityStartDate__c, k.KimbleOne__DeliveryGroup__c, k.KimbleOne__DeliveryElementScopedWith__c, k.KimbleOne__DeliveryElementRaisedAgainst__c, k.KimbleOne__DeliveryElementOperatedWith__c, k.KimbleOne__DeliveryElementInvoicedWith__c, k.KimbleOne__DeliveryElementForecastWith__c, k.KimbleOne__DeliveryElementAnalysedWith__c, k.KimbleOne__CostUnitsPerPeriod__c, k.KimbleOne__CostUnitType__c, k.KimbleOne__CostPeriodType__c, k.KimbleOne__CostNumberOfPeriods__c, k.KimbleOne__CostMilestonesTotalValue__c, k.KimbleOne__CostForecastMode__c, k.KimbleOne__CostAdjustmentsTotal__c, k.KimbleOne__ContractRevenue__c, k.KimbleOne__ContractMargin__c, k.KimbleOne__ContractMarginAmount__c, k.KimbleOne__ContractCost__c, k.KimbleOne__ChangeOrder__c, k.KimbleOne__CanInvoice__c, k.KimbleOne__CanDelete__c, k.KimbleOne__Calendar__c, k.KimbleOne__BusinessUnitGroup__c, k.KimbleOne__BillingAccount__c, k.KimbleOne__BaselinedDate__c, k.KimbleOne__BaselineUsage__c, k.KimbleOne__BaselineServicesContractRevenue__c, k.KimbleOne__BaselineServicesContractMargin__c, k.KimbleOne__BaselineServicesContractMarginAmount__c, k.KimbleOne__BaselineServicesContractCost__c, k.KimbleOne__BaselineExpensesContractRevenue__c, k.KimbleOne__BaselineExpensesContractCost__c, k.KimbleOne__BaselineContractRevenue__c, k.KimbleOne__BaselineContractMargin__c, k.KimbleOne__BaselineContractMarginAmount__c, k.KimbleOne__BaselineContractCost__c, k.KimbleOne__ActualUsage__c, k.IsDeleted, k.Id, k.CurrencyIsoCode, k.CreatedDate, k.CreatedById From KimbleOne__DeliveryElement__c k"
$kimbleDeliveryElements = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select k.SystemModstamp, k.Project_Type__c, k.Project_Risk_Assessment_Completed_H_S__c, k.Primary_Client_Contact__c, k.OwnerId, k.Name, k.LastViewedDate, k.LastReferencedDate, k.LastModifiedDate, k.LastModifiedById, k.LastActivityDate, k.KimbleOne__WeightedContractRevenue__c, k.KimbleOne__ShortName__c, k.KimbleOne__SalesOpportunity__c, k.KimbleOne__RiskLevel__c, k.KimbleOne__Reference__c, k.KimbleOne__Proposal__c, k.KimbleOne__ProductGroup__c, k.KimbleOne__ProbabilityCodeEnum__c, k.KimbleOne__LostReason__c, k.KimbleOne__LostReasonNarrative__c, k.KimbleOne__IsExpectedStartDateBeforeCloseDate__c, k.KimbleOne__InvoicingCcyServicesInvoiceableAmount__c, k.KimbleOne__InvoicingCcyExpensesInvoiceableAmount__c, k.KimbleOne__ForecastUsage__c, k.KimbleOne__ForecastStatus__c, k.KimbleOne__ForecastAtThisLevel__c, k.KimbleOne__ExpectedStartDate__c, k.KimbleOne__ExpectedEndDate__c, k.KimbleOne__ExpectedCurrencyISOCode__c, k.KimbleOne__ExpectedCcyExpectedContractRevenue__c, k.KimbleOne__DeliveryStatus__c, k.KimbleOne__DeliveryStage__c, k.KimbleOne__DeliveryProgram__c, k.KimbleOne__ContractRevenue__c, k.KimbleOne__ContractMargin__c, k.KimbleOne__ContractMarginAmount__c, k.KimbleOne__ContractCost__c, k.KimbleOne__BusinessUnitGroup__c, k.KimbleOne__BaselineUsage__c, k.KimbleOne__BaselineContractRevenue__c, k.KimbleOne__BaselineContractMargin__c, k.KimbleOne__BaselineContractMarginAmount__c, k.KimbleOne__BaselineContractCost__c, k.KimbleOne__ActualUsage__c, k.KimbleOne__Account__c, k.Is_Engagement_Owner__c, k.IsDeleted, k.Id, k.Finance_Contact__c, k.CurrencyIsoCode, k.CreatedDate, k.CreatedById, k.Competitive__c, k.Community__c From KimbleOne__DeliveryGroup__c k"
$kimbleDeliveryGroups = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select k.SystemModstamp, k.OwnerId, k.Name, k.LastModifiedDate, k.LastModifiedById, k.KimbleOne__WeightedContractRevenue__c, k.KimbleOne__ShortName__c, k.KimbleOne__SalesOpportunity__c, k.KimbleOne__RiskLevel__c, k.KimbleOne__Reference__c, k.KimbleOne__Proposition__c, k.KimbleOne__HighLevelWeightedContractRevenue__c, k.KimbleOne__HighLevelContractRevenue__c, k.KimbleOne__HighLevelContractCost__c, k.KimbleOne__ForecastStatus__c, k.KimbleOne__ForecastAtDetailedLevel__c, k.KimbleOne__DetailedLevelWeightedContractRevenue__c, k.KimbleOne__DetailedLevelContractRevenue__c, k.KimbleOne__DetailedLevelContractCost__c, k.KimbleOne__Description__c, k.KimbleOne__ContractRevenue__c, k.KimbleOne__ContractMargin__c, k.KimbleOne__ContractMarginAmount__c, k.KimbleOne__ContractCost__c, k.KimbleOne__BusinessUnit__c, k.KimbleOne__Account__c, k.KimbleOne__AcceptanceType__c, k.KimbleOne__AcceptanceDate__c, k.IsDeleted, k.Id, k.CurrencyIsoCode, k.CreatedDate, k.CreatedById From KimbleOne__Proposal__c k"
$kimbleProposals = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders
$soqlQuery = "Select k.Won_Reason__c, k.Weighted_Net_Revenue__c, k.SystemModstamp, k.Sector_Sym__c, k.Proposal_Contract_Revenue__c, k.Project_Type__c, k.OwnerId, k.Name, k.Lost_to_competitor_reason__c, k.LastViewedDate, k.LastReferencedDate, k.LastModifiedDate, k.LastModifiedById, k.LastActivityDate, k.KimbleOne__WonLostReason__c, k.KimbleOne__WonLostNarrative__c, k.KimbleOne__WeightedContractRevenue__c, k.KimbleOne__TaxCode__c, k.KimbleOne__ShortName__c, k.KimbleOne__ResponseRequiredDate__c, k.KimbleOne__Reference__c, k.KimbleOne__Proposition__c, k.KimbleOne__Proposal__c, k.KimbleOne__OpportunityStage__c, k.KimbleOne__OpportunitySource__c, k.KimbleOne__MarketingCampaign__c, k.KimbleOne__LostToCompetitor__c, k.KimbleOne__InvoicingCurrencyISOCode__c, k.KimbleOne__ForecastStatus__c, k.KimbleOne__Description__c, k.KimbleOne__CustomerAccount__c, k.KimbleOne__ContractRevenue__c, k.KimbleOne__ContractMargin__c, k.KimbleOne__ContractMarginAmount__c, k.KimbleOne__ContractCost__c, k.KimbleOne__CloseDate__c, k.KimbleOne__BusinessUnit__c, k.KimbleOne__Account__c, k.IsDeleted, k.Id, k.CurrencyIsoCode, k.CreatedDate, k.CreatedById, k.Country__c, k.Competitive__c, k.Community__c, k.ANTH_SalesOpportunityStagesCount__c, k.ANTH_PipelineStage__c From KimbleOne__SalesOpportunity__c k"
$kimbleSalesOpportunities = Get-KimbleSoqlDataset -queryUri $queryUri -soqlQuery $soqlQuery -restHeaders $kimbleRestHeaders

foreach ($table in @("Leads","Users","Events","Folders","Groups","GroupMembers","kimbleBusinessUnits","kimbleEvents","kimbleProducts","kimbleResources","tasks","accounts","contacts","kimbleDeliveryElements","kimbleDeliveryGroups","kimbleProposals","kimbleSalesOpportunities")){
    $dummy = Get-Variable $table
    $dummy.Value | Export-Csv -Path $env:USERPROFILE\Desktop\$($dummy.Name).csv -NoTypeInformation -Encoding UTF8
    }